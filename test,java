@SystemLog("產生加權名單")
	@RequestMapping(value = "/weightingGO",method = RequestMethod.POST)
	public @ResponseBody CommonResult<List<WeightingSlayersResultVO>> weightingGO(@RequestParam("projectId") String projectId, Principal principal) throws Exception {
	    String user = principal.getName();
		ProjectVO project = dao.getOneProject(projectId, user);
		if(project==null) {
			throw new Exception("專案已完成抽獎！");
		}
		
		ProjectVO filterProject = project.filterXSS();
        // 產生加權名單
        dao.doWeighting(filterProject);
        List<WeightingSlayersResultVO> slayerList = dao.getWeightingSlayers(projectId);
        
        List<WeightingSlayersResultVO> filterList = new ArrayList<>();
        for(WeightingSlayersResultVO slayer:slayerList) {
        	slayer.setPhone(DataUtil.maskMobile(slayer.getPhone()));;
        	slayer.setName(DataUtil.maskName(slayer.getName()));
        	slayer.setId(DataUtil.maskPersonalID(slayer.getId()));
        	slayer.setEmail(DataUtil.maskEmail(slayer.getEmail()));
            filterList.add(slayer.filterXSS());
        }
		return CommonResult.success(filterList);
	}
	
	The data in filterList at src\main\java\com\tgl\controller\LotteryController.java in line 81 may be sensitive, and it is exposed by an API at filterList in src\main\java\com\tgl\controller\LotteryController.java at line 81.


